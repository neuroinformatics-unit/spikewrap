
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery_builds/get_started/feature_overview.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_builds_get_started_feature_overview.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_builds_get_started_feature_overview.py:

Feature Overview
====================
`(2 minute read)`


``spikewrap`` provides a Python interface for managing and
sharing standardized extracellular electrophysiology pipelines.

Built on `SpikeInterface <https://github.com/SpikeInterface/spikeinterface>`_,
``spikewrap`` places emphasis on delivering standardised outputs and
materials for convenient data quality checks.

.. attention::

   ``spikewrap`` is currently in a consultation stage, where feedback on the
   workflow is being actively solicited. New features—such as sorting,
   subject-level analysis, quality checks and additional preprocessing steps—are planned for implementation soon.

   Please :ref:`get in contact <community>` with feedback and suggestions!

Running ``spikewrap``
---------------------

``spikewrap`` expects a project to be organised either in
`NeuroBlueprint <https://neuroblueprint.neuroinformatics.dev/latest/index.html>`_
format (which is :ref:`recommended <neuroblueprint-recommended>`), for example:

.. tab-set::
    :sync-group: category

    .. tab-item:: SpikeGLX

        .. code-block::

            └── rawdata/
                └── sub-001_.../
                    └── ses-001_.../
                        └── ephys/
                            ├── run-001_g0_imec0/
                            │   ├── run-001_g0_t0.imec0.ap.bin
                            │   └── run-001_g0_t0.imec0.ap.meta
                            └── run-002_g0_imec0/
                            │   ├── ...
                            └── ...

    .. tab-item:: OpenEphys

        .. code-block::

            └── rawdata/
                └── sub-001_.../
                    └── ses-001_.../
                        └── ephys/
                            └── Recording Node <ID>/
                                └── experiment1/
                                    ├── recording1/
                                    │   └── ...
                                    └── recording2/
                                    │   └── ...
                                    └── ...

or in custom formats with subject, session and recording folder levels as below:

.. dropdown:: Supported Custom Organisation

    .. tab-set::
        :sync-group: category

        .. tab-item:: SpikeGLX

            .. code-block::

                └── root_folder>/
                    └── my_subject_name/
                        └── my_session_name/
                            ├── run-001_g0_imec0/
                            │   ├── run-001_g0_t0.imec0.ap.bin
                            │   └── run-001_g0_t0.imec0.ap.meta
                            └── run-002_g0_imec0/
                            │   ├── ...
                            └── ...

        .. tab-item:: OpenEphys

            In the OpenEphys case, the input data would look like:

            .. code-block::

                └── root_folder/
                    └── my_subject_name/
                        └── my_session_name/
                            └── Recording Node <ID>/
                                └── experiment1/
                                    ├── recording1/
                                    │   └── ...
                                    └── recording2/
                                    │   └── ...
                                    └── ...

Recordings acquired with `SpikeGlx <https://billkarsh.github.io/SpikeGLX/>`_ or `OpenEphys <https://open-ephys.org/>`_
are currently supported (see :ref:`Supported Formats <supported-formats>` for details).
`Neuropixels <https://www.neuropixels.org/>`_ probes are automatically detected, otherwise a ``probe``
argument can be used to set `ProbeInterface <https://probeinterface.readthedocs.io/en/main/>`_ objects.

We can preprocess, visualise and save a recording session with a few function calls:

.. GENERATED FROM PYTHON SOURCE LINES 108-148

.. code-block:: Python


    import spikewrap as sw

    subject_path = sw.get_example_data_path() / "rawdata" / "sub-001"


    session = sw.Session(
        subject_path=subject_path,
        session_name="ses-001",
        file_format="spikeglx",  # or "openephys"
        run_names="all",
        probe=None,  # optional argument to set probe
    )


    # Run (lazy) preprocessing, for fast plotting
    # and prototyping of preprocessing steps

    session.preprocess(
        configs="neuropixels+kilosort2_5",
        per_shank=True,
        concat_runs=False,
    )

    plots = session.plot_preprocessed(
        run_idx=0,
        time_range=(0, 0.5),
        show_channel_ids=False,
        show=True
    )

    # Write preprocessed data to disk, optionally
    # in a SLURM job (if on a HPC)

    session.save_preprocessed(
        overwrite=True,
        n_jobs=12,
        slurm=False
    )




.. image-sg:: /gallery_builds/get_started/images/sphx_glr_feature_overview_001.png
   :alt: Session: ses-001, Run: run-002_g0_imec0 Shank: 1, Session: ses-001, Run: run-002_g0_imec0 Shank: 2
   :srcset: /gallery_builds/get_started/images/sphx_glr_feature_overview_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/spikewrap/spikewrap/spikewrap/process/_loading.py:139: UserWarning: The sessions or runs provided for are not in creation datetime order.
    They will be concatenated in the order provided, as:
    ['run-002_g0_imec0', 'run-001_g0_imec0'].
      warnings.warn(


    The preprocessing options are: {
        "1": [
            "phase_shift",
            {}
        ],
        "2": [
            "bandpass_filter",
            {
                "freq_max": 6000,
                "freq_min": 300
            }
        ],
        "3": [
            "common_reference",
            {
                "operator": "median",
                "reference": "global"
            }
        ]
    }

    Loading data from path: /home/runner/work/spikewrap/spikewrap/spikewrap/examples/example_tiny_data/spikeglx/rawdata/sub-001/ses-001/ephys/run-002_g0_imec0

    Loading data from path: /home/runner/work/spikewrap/spikewrap/spikewrap/examples/example_tiny_data/spikeglx/rawdata/sub-001/ses-001/ephys/run-001_g0_imec0

    Split run: run-002_g0_imec0 by shank. There are 2 shanks. 

    Split run: run-001_g0_imec0 by shank. There are 2 shanks. 
    /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages/spikeinterface/widgets/traces.py:150: UserWarning: You have selected a time after the end of the segment. The range will be clipped to 0.4999999999999989
      warnings.warn(
    /opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages/spikeinterface/widgets/traces.py:150: UserWarning: You have selected a time after the end of the segment. The range will be clipped to 0.4999999999999989
      warnings.warn(

    Saving data for: run-002_g0_imec0...

    `overwrite=True`, so deleting all files and folders (except for slurm_logs) at the path:
    /home/runner/work/spikewrap/spikewrap/spikewrap/examples/example_tiny_data/spikeglx/derivatives/sub-001/ses-001/ephys/run-002_g0_imec0

    Saving sync channel for: run-002_g0_imec0...
    write_binary_recording 
    engine=process - n_jobs=4 - samples_per_chunk=60,000 - chunk_memory=21.97 MiB - total_memory=87.89 MiB - chunk_duration=2.00s
    write_binary_recording (workers: 1 processes):   0%|          | 0/1 [00:00<?, ?it/s]    write_binary_recording (workers: 1 processes): 100%|██████████| 1/1 [00:00<00:00,  2.82it/s]    write_binary_recording (workers: 1 processes): 100%|██████████| 1/1 [00:00<00:00,  2.81it/s]
    write_binary_recording 
    engine=process - n_jobs=4 - samples_per_chunk=60,000 - chunk_memory=21.97 MiB - total_memory=87.89 MiB - chunk_duration=2.00s
    write_binary_recording (workers: 1 processes):   0%|          | 0/1 [00:00<?, ?it/s]    write_binary_recording (workers: 1 processes): 100%|██████████| 1/1 [00:00<00:00,  2.55it/s]    write_binary_recording (workers: 1 processes): 100%|██████████| 1/1 [00:00<00:00,  2.55it/s]

    Saving data for: run-001_g0_imec0...

    `overwrite=True`, so deleting all files and folders (except for slurm_logs) at the path:
    /home/runner/work/spikewrap/spikewrap/spikewrap/examples/example_tiny_data/spikeglx/derivatives/sub-001/ses-001/ephys/run-001_g0_imec0

    Saving sync channel for: run-001_g0_imec0...
    write_binary_recording 
    engine=process - n_jobs=4 - samples_per_chunk=60,000 - chunk_memory=21.97 MiB - total_memory=87.89 MiB - chunk_duration=2.00s
    write_binary_recording (workers: 1 processes):   0%|          | 0/1 [00:00<?, ?it/s]    write_binary_recording (workers: 1 processes): 100%|██████████| 1/1 [00:00<00:00,  2.78it/s]    write_binary_recording (workers: 1 processes): 100%|██████████| 1/1 [00:00<00:00,  2.78it/s]
    write_binary_recording 
    engine=process - n_jobs=4 - samples_per_chunk=60,000 - chunk_memory=21.97 MiB - total_memory=87.89 MiB - chunk_duration=2.00s
    write_binary_recording (workers: 1 processes):   0%|          | 0/1 [00:00<?, ?it/s]    write_binary_recording (workers: 1 processes): 100%|██████████| 1/1 [00:00<00:00,  3.19it/s]    write_binary_recording (workers: 1 processes): 100%|██████████| 1/1 [00:00<00:00,  3.19it/s]




.. GENERATED FROM PYTHON SOURCE LINES 149-174

with data output to the standardised
`NeuroBlueprint <https://neuroblueprint.neuroinformatics.dev/latest/index.html>`_
structure:

.. code-block::

   └── root_folder/
       └── derivatives/
           └── sub-001/
               └── ses-001  /
                   └── ephys/
                       └── run-001_g0_imec0/
                       │   ├── preprocessed/
                       │   │   ├── shank_0/
                       │   │   │   └── si_recording/
                       │   │   │       └── <spikeinterface binary>
                       │   │   └── shank_1/
                       │   │       └── si_recording/
                       │   │           └── <spikeinterface binary>
                       │   └── sync/
                       │       └── sync_channel.npy
                       └── run-002_g0_imec0/
                           └── ...

Next, visit :ref:`get-started` and :ref:`tutorials_index` to try out ``spikewrap``.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 2.691 seconds)


.. _sphx_glr_download_gallery_builds_get_started_feature_overview.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/neuroinformatics-unit/spikewrap/gh-pages?filepath=notebooks/gallery_builds/get_started/feature_overview.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: feature_overview.ipynb <feature_overview.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: feature_overview.py <feature_overview.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: feature_overview.zip <feature_overview.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
